<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Ranks - Thesdel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { background-color: #000000; color: #FFFFFF; font-family: 'Plus Jakarta Sans', sans-serif; }
        .glass-panel { background: rgba(18, 18, 18, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .rank-card { transition: 0.3s; border-left: 4px solid transparent; }
        .rank-1 { border-left-color: #ff6600; background: linear-gradient(90deg, rgba(255,102,0,0.1) 0%, rgba(0,0,0,0) 100%); }
        .nav-link { color: #666; font-size: 9px; font-weight: 800; text-transform: uppercase; text-decoration: none; }
        .nav-active { color: #ff6600; }
    </style>
</head>
<body class="p-5 pb-32">

    <header class="mb-10">
        <h2 class="text-3xl font-black text-white uppercase tracking-tighter">Global <span class="text-orange-500">Ranks</span></h2>
        <p class="text-gray-500 text-[10px] font-bold uppercase tracking-[0.2em]">The Elite Leaderboard</p>
    </header>

    <div id="podium-container" class="flex items-end justify-center gap-4 mb-10 h-32 text-center">
        </div>

    <main class="space-y-3" id="leaderboard-list">
        <p class="text-center text-gray-600 animate-pulse uppercase text-[10px] font-bold py-10">Fetching Legends...</p>
    </main>

    <nav class="fixed bottom-8 left-1/2 -translate-x-1/2 w-[92%] glass-panel rounded-full p-2 flex justify-between items-center z-50">
        <a href="index.html" class="flex-1 text-center nav-link">Home</a>
        <a href="build.html" class="flex-1 text-center nav-link">Build</a>
        <a href="index.html" class="relative -mt-12"><div class="bg-orange-600 h-14 w-14 rounded-full flex items-center justify-center border-4 border-black text-white text-2xl">+</div></a>
        <a href="join.html" class="flex-1 text-center nav-link">Tests</a>
        <a href="ranks.html" class="flex-1 text-center nav-link nav-active">Ranks</a>
    </nav>

    <script>
        const _URL = "https://lgfyrlfjoazedwymjpfc.supabase.co";
        const _KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxnZnlybGZqb2F6ZWR3eW1qcGZjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY1MTc1MTksImV4cCI6MjA4MjA5MzUxOX0.g1xVMCtSkkQIu2s1pkvWwxDDvgNGbikAMkyfbZJywVw";
        const sb = supabase.createClient(_URL, _KEY);

        async function loadRanks() {
            const { data: users, error } = await sb
                .from('profile')
                .select('first_name, xp')
                .order('xp', { ascending: false })
                .limit(20);

            if (users) {
                const list = document.getElementById('leaderboard-list');
                const podium = document.getElementById('podium-container');
                
                // Set Podium (Top 3)
                podium.innerHTML = users.slice(0, 3).map((u, i) => `
                    <div class="flex-1 flex flex-col items-center">
                        <div class="text-orange-500 font-black text-xs">#${i+1}</div>
                        <div class="w-full bg-white/5 rounded-t-xl border-x border-t border-white/10" style="height: ${60 - (i*15)}px"></div>
                        <p class="text-[10px] font-bold uppercase mt-2 truncate w-20">${u.first_name}</p>
                    </div>
                `).reverse().join(''); // Reverse so #1 is in the middle

                // Set List
                list.innerHTML = users.map((u, i) => `
                    <div class="glass-panel p-5 rounded-2xl flex justify-between items-center rank-card ${i === 0 ? 'rank-1' : ''}">
                        <div class="flex items-center gap-4">
                            <span class="text-gray-500 font-black w-6">#${i + 1}</span>
                            <div>
                                <p class="font-bold uppercase text-sm">${u.first_name}</p>
                                <p class="text-[9px] text-gray-500 font-bold uppercase tracking-widest">${getRankTitle(u.xp)}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-black text-white">${u.xp.toLocaleString()}</p>
                            <p class="text-[8px] text-orange-500 font-bold uppercase">Total XP</p>
                        </div>
                    </div>
                `).join('');
            }
        }

        function getRankTitle(xp) {
            if (xp > 5000) return "Grandmaster";
            if (xp > 2500) return "Elite Architect";
            if (xp > 1000) return "Pro Scholar";
            return "Rookie";
        }

        loadRanks();
    </script>
</body>
</html>
            
